{% extends "base.html" %}

{% block title %}Modify Order{% endblock %}

{% block page_title %}Modify Order {{order}}{% endblock page_title %}

{% block content %}

<!--<div>
  <form action="" method="post">{% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Update" />
  </form>
</div>-->

<form action="" method="POST">
  {% csrf_token %}
  
  <!--{{ form.as_p }}-->

  {{ form.non_field_errors }} 

  <fieldset id="order-info">
    <legend>Order info</legend>

     <div class="field-wrapper inline">
       {{ form.number.errors }}
       <label for="id_number">Order #</label>
       {{ form.number }}
     </div>
     <div class="field-wrapper inline">
       {{ form.status.errors }}
       <label for="id_status">Status</label>
       {{ form.status }}
     </div>
     <div class="field-wrapper inline clear">
       {{ form.vendor_order_no.errors }}
       <label for="id_vendor_order_no">Vendor  Order #</label>
       {{ form.vendor_order_no }}
     </div>
     <div class="field-wrapper inline">
       {{ form.vendor_placed_order_date.errors }}
       <label for="id_vendor_placed_order_date">Date Order Placed with Vendor</label>
       {{ form.vendor_placed_order_date}}
     </div>

     <div class="field-wrapper clear">
       {{ form.store.errors }}
       <label for="id_store">Store</label>
       {{ form.store }}
     </div>

  </fieldset>

  <fieldset id="customer-info">
    <legend>Customer Info</legend>
    <div class="customer-selection">
      <h5>Select existing or create a customer</h5>
      <div class="field-wrapper">
        {{ form.customer.errors }}
        <label for="id_customer">Customer</label>
        {{ form.customer }}
      </div>
      <fieldset id="new-customer-form" class="fieldset-inline">
        <legend>Create a customer</legend>
        {{ customer_form.management_form }}
        {% for subform in customer_form %}
          {{ subform.non_field_errors }}
          <div class="form-row inline">
            {{ subform }}
          </div>
        {% endfor %}
      </fieldset>
    </div>
  </fieldset>

  <fieldset>
    <legend>Payment Information</legend>
    <div class="field-wrapper">
      {{ form.subtotal_after_discount.errors }}
      <label for="id_subtotal_after_discount">Subtotal After Discount</label>
      {{ form.subtotal_after_discount }}
    </div>
    <div class="field-wrapper">
      {{ form.deposit_balance.errors }}
      <label for="id_deposit_balance">Deposit Balance</label>
      {{ form.deposit_balance }}
    </div>
    <div class="field-wrapper">
      {{ form.tax.errors }}
      <label for="id_tax">Tax</label>
      {{ form.tax }}
    </div>
    <div class="field-wrapper">
      {{ form.shipping.errors }}
      <label for="id_shipping">Shipping</label>
      {{ form.shipping }}
    </div>
  </fieldset>
  
  <fieldset id="order-items-fieldset" class="accordion">
    <legend>Sold Items</legend>
    {{ items_form.management_form }}
    {{ items_form.non_field_errors }}    
    {% for item_form in items_form %}
      <div class="accordion-group items-form form-row">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#order-items-fieldset" href="#collapse{{forloop.counter}}">
            Item
          </a>
        </div>
        <div id="collapse{{forloop.counter}}" class="accordion-body collapse in">
          <div class="accordion-inner">
            {{ item_form }}
          </div>
        </div>       
      </div>
    {% endfor %}
  </fieldset>

  <div class="field-wrapper">
    {{ form.comments.errors }}
    <label for="id_comments">Comments</label>
    {{ form.comments }}
  </div>


  <fieldset class="formset">
    <legend>Commissions</legend>
    {{ commission_form.management_form }}
    {{ commission_form.non_form_errors }}
    {% for com_form in commission_form %}
      <div class="form-row inline">
        {{ com_form.as_p }}
      </div>
    {% endfor %}
  </fieldset>

  <input type="submit" value="Save"/>

</form>

{% endblock content %}
